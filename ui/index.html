<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Support Toolkit — Template Preview</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Customer Support Automation Toolkit</h1>
    <p>Preview templates, customize placeholders, and copy responses.</p>
  </header>

  <main>
    <section class="controls">
      <div class="field">
        <label for="language">Language</label>
        <select id="language">
          <option value="english">English</option>
          <option value="spanish">Español</option>
        </select>
      </div>
      <div class="field">
        <label for="type">Template</label>
        <select id="type">
          <option value="refund">Refund</option>
          <option value="apology">Apology</option>
          <option value="escalation">Escalation</option>
        </select>
      </div>
      <div class="field">
        <label for="name">Name</label>
        <input id="name" placeholder="Customer name" />
      </div>
      <div class="field">
        <label for="order">Order</label>
        <input id="order" placeholder="Order ID" />
      </div>
      <div class="field">
        <label for="ticket">Ticket</label>
        <input id="ticket" placeholder="Ticket ID" />
      </div>
      <button id="load">Preview</button>
      <button id="copy">Copy</button>
    </section>

    <section class="preview">
      <pre id="content">Select a template and click Preview.</pre>
    </section>
  </main>

  <footer>
    <small>Built for efficient, empathetic support.</small>
  </footer>

  <script>
    const contentEl = document.getElementById('content');
    const loadBtn = document.getElementById('load');
    const copyBtn = document.getElementById('copy');

    async function loadTemplate(lang, type) {
      const path = `../templates/${lang}/${type}.md`;
      const res = await fetch(path);
      if (!res.ok) {
        return `Unable to load template: ${path}`;
      }
      return await res.text();
    }

    function stamp(text) {
      const name = document.getElementById('name').value || 'Customer';
      const order = document.getElementById('order').value || '';
      const ticket = document.getElementById('ticket').value || '';
      const date = new Date().toLocaleDateString();

      return text
        .replaceAll('{{name}}', name)
        .replaceAll('{{order}}', order)
        .replaceAll('{{ticket}}', ticket)
        .replaceAll('{{date}}', date);
    }

    loadBtn.addEventListener('click', async () => {
      const lang = document.getElementById('language').value;
      const type = document.getElementById('type').value;
      const raw = await loadTemplate(lang, type);
      contentEl.textContent = stamp(raw);
    });

    copyBtn.addEventListener('click', async () => {
      await navigator.clipboard.writeText(contentEl.textContent);
      copyBtn.textContent = 'Copied!';
      setTimeout(() => (copyBtn.textContent = 'Copy'), 1200);
    });
  </script>
</body>
</html>